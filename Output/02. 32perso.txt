LOCAL STRING CMD
LOCAL STRING RESP
LOCAL STRING SW
LOCAL STRING DATA
LOCAL NUMERIC P2
LOCAL STRING ELFAID
LOCAL STRING EMAID


LOCAL STRING AID_PBOC "A0000003330101"
LOCAL STRING AID_PSE "315041592E5359532E4444463031"
LOCAL STRING AID_PPSE "325041592E5359532E4444463031"

LOCAL STRING HRN "0000000000000000"
LOCAL STRING ISD_MK "404142434445464748494A4B4C4D4E4F404142434445464748494A4B4C4D4E4F404142434445464748494A4B4C4D4E4F"

// RESET
POWERON USERCARD RESP

// Mutual Auth
GPSETDESKEY ISD_MK
GPMUTUALAUTH USERCARD 0 HRN 1 RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT



// INSTALL[FOR INSTALL]

SET ELFAID "A00000033301"
SET EMAID "A0000003330101"
GPINSTALLFORINSTALL USERCARD ELFAID EMAID AID_PBOC 0x10 "" "" RESP SW "9000"

SET ELFAID "315041592E"
SET EMAID "315041592E5359532E4444463031"
GPINSTALLFORINSTALL USERCARD ELFAID EMAID AID_PSE 0 "" "" RESP SW "9000"
GPINSTALLFORINSTALL USERCARD ELFAID EMAID AID_PPSE 0 "" "" RESP SW "9000"

// RESET
POWERON USERCARD RESP

// PBOC Selects
GPSELECT USERCARD AID_PBOC RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Mutual Auth
GPSETDESKEY ISD_MK
GPMUTUALAUTH USERCARD 0 HRN 1 RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

SET P2 0


// PERSONALIZATION PBOC

SET DATA "910252A550500B50424F43204372656469748701019F380F9F1A029F7A019F02065F2A029F4E145F2D087A68656E667264659F1101019F120F4341524420494D414745203030343EBF0C0A9F4D020B0ADF4D020C0A"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "91035FA55D500B50424F43204372656469748701019F38189F66049F02069F03069F1A0295055F2A029A039C019F37045F2D087A68656E667264659F1101019F120F4341524420494D414745203030343EBF0C0EDF6101109F4D020B0ADF4D020C0A"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "91041682027C00941008010200080505011003070020010100"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "92031A82027C0094140801020008030401100304001008090020010100"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "92072382027C009410080505011003070020010100280303009F100A07010103000000010A01"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1


SET DATA "92000D9F100A07010103000000010A01"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "800030112233440066778811223344550077888B4F854F0831FBF2635A212E4DDDB92A11220044556677881122330055667788"
GPSTOREDATA USERCARD 0x60 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1


SET DATA "90000997DCB0CE4E2CB37DF3"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1


SET DATA "801008241234FFFFFFFFFF"
GPSTOREDATA USERCARD 0x60 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "9010020303"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1


SET DATA "01012E702C57116228000100001117D301220101234567899F1F1630313032303330343035303630373038303930413042"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "01021870165F200F46554C4C2046554E4354494F4E414C5F340101"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "010381707F8E0A000000000000000001009F0D057C70B808009F0E057C70B808009F0F0500000000005F25039507015F24033012315A0862280001000011179F080200309F0702FFC05F280201568C189F02069F03069F1A0295055F2A029A039F21039C019F37048D1A8A029F02069F03069F1A0295055F2A029A039F21039C019F3704"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "01043870369F74064543433131319F482AF28AEE954ECDC5B4C0FAD9EFCB659FE3C01E431F3440B3E0167DD5DCDE431E1378745DAE9D4C50432D7D"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "01051D701B5A0862280001000011175F24033012315F25039507019F08020030"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0203B67081B39081B0E5A476B7802A368CB511989629787CFE7DBDB57D37F94F258F97B355D14F2A9F3184C41A2F99711C23D689CD49B8C178DD64092F52BA3B54A4B0246C11FA3224D6A4A7DC68DF3DFF1CE4787331FBD5416103BF62B7F98998048AE40B13988AD07DA6DC55E42F897326AFF443EAB4710F7139DA3656F479CB550C6E2B8DFC9D809E0B419BD8D22CFA5463570D133C1FAFAFA728107AC335B27B2CA076C5FA13C24F494D04EABD56FCFF42162E5117A8F0"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "02044370418F01849224AFC9AAD1082B549F009EAD566BE0EB610EB8897033EF2296330DD3C3B04BB7C1D7E3C4819F4701039F3201039F49039F37049F420201565F30020201"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0205A070819D8E120000000000000000410342035E0343031F009F0D05F0200400009F0E0500508800009F0F05F0200498009F0702FFC05F280201568C189F02069F03069F1A0295055F2A029A039F21039C019F37048D1A8A029F02069F03069F1A0295055F2A029A039F21039C019F37049F4A01829F482AF28AEE954ECDC5B4C0FAD9EFCB659FE3C01E431F3440B3E0167DD5DCDE431E1378745DAE9D4C50432D7D"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0206B67081B39381B0B65F3F650BD5E345526CAB43256AD4F6EA68038EBEF501D453CF2EE4EBA3D073F5B3B3500F26505CA398846F66B26DAD83B6B45B2D7DE2C58622E1243B5C3A08DDD2A8D717B6696ED46B71496F83557B57BD0F1CC37EEDCB038BBECE1F2D8F5B8D45B76DBB6CB542E1E7AB57A5DC52493E7352E2593013C6A7ABAB8E29ADA5B75301298ECAAD5B62A7B2298F1290DBD34848837960E32B7D34F01FFFB968A9DFE79C564F86100C8241583E2121AD56BA"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0207B77081B49F4681B0C5D5206E1C2599E18FE641BB4F515F0E0586C3DB3392909F754EED3C3AF6B231444FA08E3DF03CF62A8E3A7D75EF1BDA8D66A8D1F21B3072E9EC74F914623CD534D593DA4DA94B6C45362C95F186E72C19DD6CB91337846250B6587E142415CAE50F64CAD8992ED21091CA06944478EBA23C630C052FE94E70829182B5CAF665660946DC99AA579CCD7B3CFBE6E1A3FB075C24B3E3345AFA0034A012B29D4FBB850299E12DEFE4C8AEBDE5643EA6C3F9"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0208B67081B39381B0270CFA27E2EB7B553CB27C56C48C71020B72E239C0F180F709EC236685FF884E598A5076C91664368D0CABC9BDC55247578E2C58FB144285E75FD1C93A69A1944FDBDBD6B9F41176BF3CA27ECA4CF81666CB8D4B5E3673948C62729F98B72A70D3D38C43EFBC5BBD16FB36DACF0A53EDABCDA90BAAECDEECFB716F34B5698707BCA74E57A24111EA23292966D9806E9D25BC9E6A3220259EF4DA5739F2031FF331A6B0A9CCE1171F8AD261B290686B92"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0209B77081B49F4681B0A6A01321DC75A60769DD7049BA452F4128B2D7CC2E50452B0FEE5ADBA4C40AB8E2E49482D9F6B73AC8EDE172BFE4DADE47AFCF6D950CE46562D0A3926FCB3AD11D726F61CDCCC014909BEC4FDBA90F9AE9E832DEA720DDB1C2B19C29832EB124D7E87444DBACC17774835E1F90202FDAACA9550494317315ADAF9490F362EA29164246DB886D2160343C935E593ABF3C2A30D8A7B3E6E1A5BACAADC1BB83CDF4772BFAC22C635710157955B2382283DF"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "04013D703B9F1401039F2301079F241D11223344556677889900112233445566778899001122334455667788999F631011223344556677880000000000000000"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "05031670149F74064543433131319F69080100000000000000"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0D018D9F5801039F5901079F5301039F7201009F54060000000100009F77060000000150009F78060000000010009F79060000000100009F6B060000000005009F6D060000000015009F6804831040009F6C0230009F5D06000000000001DF71020344DF7206000000000500DF7606000000003000DF7706000000030000DF7806000000002000DF7906000000020000"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "0E01AD9F130200009F241D11223344556677889900112233445566778899001122334455667788999F510201569F52021E429F5601809F570201569F7602000057116228000100001117D301220101234567895F200F46554C4C2046554E4354494F4E414C5F3401019F6310112233445566778800000000000000009F360200009F4F199A039F21039F02069F03069F1A025F2A029F4E149C019F3602DF4F109A039F21039F1A029F4E149C019F3602"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1
 

SET DATA "820160CAACCAB9F685356F8E0F3A72733BE0ED370D0F4B276F19EB009D7317A010E69AA26988ECE98306FEBDE63A29F92B9F151AE46C979D096807484A5FFA126D7C0B1E0FC0FBC2783BCAC9140C0A138036DD205262A05995FACA8000000000000000"
GPSTOREDATA USERCARD 0x60 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "8202608982A7AE7E9A9C2F7EE9F35A05EED39DA5397F994D3D5A5537347B8A83C3A4B45661A3DF061023528704A249A1F3F1F95922EA04F40572A6244F9E1AC72BA3B5763099D8A5717482D35F2AB224220008E7943C45AEC9AA0F8000000000000000"
GPSTOREDATA USERCARD 0x60 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "8203609370673702378578787F2DAF8013469A391DD1683245648247D7B429912E7F36E0EFD6B350A5A537F3D3615B4DB1B75BEBED7B00D1D76894BA07AB8B097ACEAFB0A4674F444CEF07337DBF6FBC37BFFFB09E7BED41BB23078000000000000000"
GPSTOREDATA USERCARD 0x60 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "820560DD289AD283534834B4BEC487401CE9E755ACBA1C4B6816C36BC38E3E59C5BED25167C20CF8F877D3EDBD1208F48A9309E1E438813AC31CDF170B81508E38360788F69AF6E673668ACD3C9F279A539FFF88EDB9E3E298B48B8000000000000000"
GPSTOREDATA USERCARD 0x60 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1

SET DATA "820460CE43FB85BDE7EA473E5EED0708E63D6C77D63F65F3DC077FD2CEB94FC5A5770E819275CE891834FBCA86F36E72EDEAF605B45F076E082BF936776D282AC175903148E6C4F82A2EC43D0EC00B3633000D5B5E5A68862E7F178000000000000000"
GPSTOREDATA USERCARD 0xE0 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1



// RESET
POWERON USERCARD RESP

// PSE Selects
GPSELECT USERCARD AID_PSE RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Mutual Auth
GPSETDESKEY ISD_MK
GPMUTUALAUTH USERCARD 0 HRN 1 RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

SET P2 0

SET DATA "010131702F612D4F08A000000333010102500B50424F43204352454449549F12104343422050424F43332E302043415244870101"
GPSTOREDATA USERCARD 0x00 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1


SET DATA "91021BA5198801015F2D027A689F110101BF0C0A9F4D020B0ADF4D020C0A"
GPSTOREDATA USERCARD 0x80 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1


// RESET
POWERON USERCARD RESP

// PPSE Selects
GPSELECT USERCARD AID_PPSE RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Mutual Auth
GPSETDESKEY ISD_MK
GPMUTUALAUTH USERCARD 0 HRN 1 RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

SET P2 0

SET DATA "910221A51FBF0C1C611A4F08A000000333010102500B50424F4320435245444954870101"
GPSTOREDATA USERCARD 0x80 P2 DATA RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
ADD P2 P2 1





ERROR_SCRIPT:


























