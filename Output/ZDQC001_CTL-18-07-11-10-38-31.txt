LOCAL STRING CMD
LOCAL STRING RESP
LOCAL STRING SW
LOCAL STRING DATA
LOCAL STRING TEMP
LOCAL STRING AID
LOCAL STRING AIP
LOCAL STRING AFL
LOCAL STRING CID
LOCAL STRING ATC
LOCAL STRING PDOL_DATA
LOCAL STRING CDOL1_DATA
LOCAL STRING CDOL2_DATA
LOCAL STRING RESP_AC1
LOCAL STRING RESP_AC2
LOCAL STRING CAC
LOCAL STRING IAD
LOCAL STRING CVR
LOCAL STRING AOSA
LOCAL STRING SESK
LOCAL STRING CALCULATED_AC
LOCAL STRING ARQC
LOCAL STRING MAC
LOCAL STRING UDK "11223344006677881122334455007788"
LOCAL STRING MDK "8B4F854F0831FBF2635A212E4DDDB92A"
LOCAL STRING ENC "11223344006677881122334455007788"
LOCAL STRING AID_PSE "315041592E5359532E4444463031"
LOCAL STRING AID_PPSE "325041592E5359532E4444463031"
LOCAL STRING AID_PBOC "A0000003330101"

// ==========================transaction 1==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000015618071100A8F2ECEE"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION1_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION1_GPO_RESPONSE_TAG_77_END
TRANSACTION1_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION1_GPO_RESPONSE_TAG_77_END:

// Get Data
SET CMD "80CA9F5200"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5600"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 2==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000015618071100A8F2ECEF"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION2_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION2_GPO_RESPONSE_TAG_77_END
TRANSACTION2_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION2_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000015618071110384500A8F2ECEF"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION2_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION2_1st_GENERATE_AC_TAG_77_END
TRANSACTION2_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION2_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000156180711" "00A8F2ECEF"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000015618071110384500A8F2ECEF"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION2_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION2_2nd_GENERATE_AC_TAG_77_END
TRANSACTION2_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION2_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000015618" "00A8F2ECEF"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0

// Put Data
SET CMD "04DADF6105"

// Get Data
SET CMD "80CADF6100"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7200"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7600"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 3==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2ECED"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION3_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION3_GPO_RESPONSE_TAG_77_END
TRANSACTION3_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION3_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 4==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000015618071100A8F2ECE3"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION4_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION4_GPO_RESPONSE_TAG_77_END
TRANSACTION4_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION4_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000015618071110384900A8F2ECE3"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION4_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION4_1st_GENERATE_AC_TAG_77_END
TRANSACTION4_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION4_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000156180711" "00A8F2ECE3"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000015618071110384900A8F2ECE3"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION4_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION4_2nd_GENERATE_AC_TAG_77_END
TRANSACTION4_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION4_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000015618" "00A8F2ECE3"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 5==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2ECFB"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION5_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION5_GPO_RESPONSE_TAG_77_END
TRANSACTION5_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION5_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 6==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000040000000000000001560000000000034495070200A8F2ECF8"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION6_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION6_GPO_RESPONSE_TAG_77_END
TRANSACTION6_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION6_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 7==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000040000000000000001560000000000034418071100A8F2ECFE"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION7_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION7_GPO_RESPONSE_TAG_77_END
TRANSACTION7_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION7_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000040000000000000001560000000000034418071110385400A8F2ECFE"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION7_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION7_1st_GENERATE_AC_TAG_77_END
TRANSACTION7_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION7_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000400000000000000015600000000000344180711" "00A8F2ECFE"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000040000000000000001560000000000034418071110385400A8F2ECFE"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION7_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION7_2nd_GENERATE_AC_TAG_77_END
TRANSACTION7_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION7_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000040000000000000001560000000000034418" "00A8F2ECFE"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 8==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000040000000000000001560000000000034495070200A8F2ECFC"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION8_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION8_GPO_RESPONSE_TAG_77_END
TRANSACTION8_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION8_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 9==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2ECF2"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION9_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION9_GPO_RESPONSE_TAG_77_END
TRANSACTION9_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION9_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 10==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000084018071100A8F2ECF3"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION10_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION10_GPO_RESPONSE_TAG_77_END
TRANSACTION10_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION10_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000084018071110385900A8F2ECF3"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION10_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION10_1st_GENERATE_AC_TAG_77_END
TRANSACTION10_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION10_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000840180711" "00A8F2ECF3"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000084018071110385900A8F2ECF3"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION10_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION10_2nd_GENERATE_AC_TAG_77_END
TRANSACTION10_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION10_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000084018" "00A8F2ECF3"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 11==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2EDA8"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION11_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION11_GPO_RESPONSE_TAG_77_END
TRANSACTION11_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION11_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 12==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000015618071100A8F2EDA9"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION12_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION12_GPO_RESPONSE_TAG_77_END
TRANSACTION12_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION12_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000015618071110390300A8F2EDA9"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION12_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION12_1st_GENERATE_AC_TAG_77_END
TRANSACTION12_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION12_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000156180711" "00A8F2EDA9"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000015618071110390300A8F2EDA9"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION12_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION12_2nd_GENERATE_AC_TAG_77_END
TRANSACTION12_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION12_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000015618" "00A8F2EDA9"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0

// Put Data
SET CMD "04DADF6105"

// Get Data
SET CMD "80CADF6100"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7200"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CADF7600"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 13==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2EDAF"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION13_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION13_GPO_RESPONSE_TAG_77_END
TRANSACTION13_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION13_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 14==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000015618071100A8F2EDAC"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION14_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION14_GPO_RESPONSE_TAG_77_END
TRANSACTION14_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION14_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000015618071110390600A8F2EDAC"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION14_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION14_1st_GENERATE_AC_TAG_77_END
TRANSACTION14_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION14_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000156180711" "00A8F2EDAC"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000015618071110390600A8F2EDAC"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION14_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION14_2nd_GENERATE_AC_TAG_77_END
TRANSACTION14_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION14_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000015618" "00A8F2EDAC"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:���ر�ǩcheck_data  ֵʵΪ��000000014800</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:Ҫ���ǩcheck_data  ֵӦΪ��000000015000</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000015000</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 15==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2EDA2"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION15_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION15_GPO_RESPONSE_TAG_77_END
TRANSACTION15_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION15_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000014800</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 16==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000040000000000000001560000000000034495070200A8F2EDBA"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION16_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION16_GPO_RESPONSE_TAG_77_END
TRANSACTION16_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION16_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 17==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000014800</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000040000000000000001560000000000034418071100A8F2EDBB"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION17_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION17_GPO_RESPONSE_TAG_77_END
TRANSACTION17_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION17_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000040000000000000001560000000000034418071110391100A8F2EDBB"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION17_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION17_1st_GENERATE_AC_TAG_77_END
TRANSACTION17_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION17_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000400000000000000015600000000000344180711" "00A8F2EDBB"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000040000000000000001560000000000034418071110391100A8F2EDBB"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION17_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION17_2nd_GENERATE_AC_TAG_77_END
TRANSACTION17_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION17_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000040000000000000001560000000000034418" "00A8F2EDBB"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:���ر�ǩcheck_data  ֵʵΪ��000000029200</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:Ҫ���ǩcheck_data  ֵӦΪ��000000030000</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000030000</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 18==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000040000000000000001560000000000034495070200A8F2EDB9"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION18_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION18_GPO_RESPONSE_TAG_77_END
TRANSACTION18_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION18_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000029600</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 19==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2EDBF"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION19_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION19_GPO_RESPONSE_TAG_77_END
TRANSACTION19_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION19_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 20==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000014600</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000084018071100A8F2EDBC"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION20_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION20_GPO_RESPONSE_TAG_77_END
TRANSACTION20_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION20_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000084018071110391600A8F2EDBC"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION20_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION20_1st_GENERATE_AC_TAG_77_END
TRANSACTION20_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION20_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000840180711" "00A8F2EDBC"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000084018071110391600A8F2EDBC"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION20_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION20_2nd_GENERATE_AC_TAG_77_END
TRANSACTION20_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION20_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000084018" "00A8F2EDBC"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:���ر�ǩcheck_data  ֵʵΪ��000000014400</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:Ҫ���ǩcheck_data  ֵӦΪ��000000014600</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000014600</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 21==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "83212600008000000000020000000000000001560000000000015695070200A8F2EDB2"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION21_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION21_GPO_RESPONSE_TAG_77_END
TRANSACTION21_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION21_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2011C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2032C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7800"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F7900"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// comment :  <p style="color:FF0000">Error:��Ƭ����9F79ֵӦΪ000000014400</p>
COMPARE "00" "FF" 0
// ERROR!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F5D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// ==========================transaction 22==========================
// RESET
POWERON USERCARD RESP

// SELECT PPSE
SET AID "325041592E5359532E4444463031"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// SELECT PBOC
SET AID "A0000003330101"
GPSELECT USERCARD AID RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// GPO
SET PDOL_DATA "8321F600000000000000020000000000000001560000000000015618071100A8F2ED8A"
APPEND CMD "80A8000023" PDOL_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION22_GPO_RESPONSE_TAG_77
MID AIP RESP 5 4
MID AFL RESP 9
JMP TRANSACTION22_GPO_RESPONSE_TAG_77_END
TRANSACTION22_GPO_RESPONSE_TAG_77:

FINDTLV AIP "82" RESP
FINDTLV AFL "94" RESP
FINDTLV ATC "9F36" RESP
FINDTLV IAD "9F10" RESP
MID CVR IAD 7 8
TRANSACTION22_GPO_RESPONSE_TAG_77_END:

// Read Record
SET CMD "00B2010C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2020C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2050C00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2031400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2041400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2051400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2061400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2071400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Read Record
SET CMD "00B2012400"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Get Data
SET CMD "80CA9F1700"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Verify Pin
APPEND CMD "0020008008" "241234FFFFFFFFFF"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 1st Generate AC
SET CDOL1_DATA "00000000020000000000000001560000000000015618071110392000A8F2ED8A"
APPEND CMD "80AE800020" CDOL1_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION22_1st_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC1 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION22_1st_GENERATE_AC_TAG_77_END
TRANSACTION22_1st_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC1 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION22_1st_GENERATE_AC_TAG_77_END:

NOT TEMP ATC
APPEND DATA "000000000000" ATC "000000000000" TEMP
CIPHER SESK DATA UDK TDES_ENC_ECB

APPEND TEMP "000000000200000000000000015600000000000156180711" "00A8F2ED8A"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC1 0

// External Authenticate
APPEND DATA "3030" "000000000000"
XOR DATA CAC DATA
APPEND DATA DATA "0000000000000000"
CIPHER ARQC DATA SESK TDES_ENC_ECB
LEFT ARQC ARQC 16
APPEND CMD "008200000A" ARQC "3030"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// 2nd Generate AC
SET CDOL2_DATA "303000000000020000000000000001560000000000015618071110392000A8F2ED8A"
APPEND CMD "80AE400022" CDOL2_DATA
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

LEFT TEMP RESP 2
JE TEMP "77" TRANSACTION22_2nd_GENERATE_AC_TAG_77
MID ATC RESP 7 4
MID RESP_AC2 RESP 11 16
MID CVR RESP 33 8

JMP TRANSACTION22_2nd_GENERATE_AC_TAG_77_END
TRANSACTION22_2nd_GENERATE_AC_TAG_77:
FINDTLV ATC "9F36" RESP
FINDTLV RESP_AC2 "9F36" RESP
FINDTLV IAD "9F36" RESP
TRANSACTION22_2nd_GENERATE_AC_TAG_77_END:

APPEND TEMP "303000000000020000000000000001560000000000015618" "00A8F2ED8A"
APPEND DATA TEMP AIP ATC CVR
PADDING DATA DATA PAD_ISO9797_M2
CIPHER CAC DATA SESK DES_TDES_MAC
COMPARE CAC RESP_AC2 0

// Put Data
SET CMD "04DA9F6B0A"

// Get Data
SET CMD "80CA9F6B00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Put Data
SET CMD "04DA9F6D0A"

// Get Data
SET CMD "80CA9F6D00"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Put Data
SET CMD "04DADF720A"

// Get Data
SET CMD "80CADF7200"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT

// Put Data
SET CMD "04DADF760A"

// Get Data
SET CMD "80CADF7600"
SENDAPDU USERCARD CMD RESP SW "9000"
JNE SW "9000" ERROR_SCRIPT
